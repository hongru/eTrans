(function(e,t){typeof define=="function"?define(t):typeof module!="undefined"?module.exports=t():this[e]=t()})("ETrans",function(){function t(t){return e.transform3d?"translate3d(0, "+t+"px, 0)":"translate(0, "+t+"px)"}function n(t){return e.transform3d?"translate3d("+t+"px, 0, 0)":"translate("+t+"px, 0)"}function r(e,t){var n=null,r=document.defaultView.getComputedStyle(e,"");return r&&(n=r[t]),e.style[t]||n}function i(e){var t=r(e,"webkitTransform"),n=/translate(X|Y|Z|3d)?\(([^\)]+)\)/,i=t.match(n),s={x:0,y:0,z:0};if(i){if(!i[1]){var o=i[2].split(",");s.x=parseInt(o[0]),s.y=parseInt(o[1]||0)}else if(i[1]=="X")s.x=parseInt(i[2]);else if(i[1]=="Y")s.y=parseInt(i[2]);else if(i[1]=="Z")s.z=parseInt(i[2]);else if(i[1]=="3d"){var u=i[2].split(",");s.x=parseInt(o[0]||0),s.y=parseInt(o[1]||0),s.z=parseInt(o[2]||0)}return s}}function s(e){return String.prototype.trim?e.trim():e.replace(/(^\s*|\s*$)/g,"")}var e={transform3d:"WebKitCSSMatrix"in window,touch:"ontouchstart"in window},o=function(e,t){this._prevHash=null,this._curHash=null,this._prevEl=null,this._curEl=null,this.setMap(e),this.setConf(t),this._bindEvents(),this.navigate(location.hash)};return o.prototype={setMap:function(e){var t={};for(var n in e)typeof e[n]=="string"&&(e[n]=document.querySelector(e[n]),e[n]&&e[n].setAttribute("data-mh",n),t[n]=new RegExp(n));this.map=e,this._hash2reg=t},setConf:function(e){if(typeof e=="object"){this.conf=e,this.driveByHash=!!this.conf.driveByHash;if(this.conf.backward){this.conf._backward=this.conf._backward||{};for(var t=0;t<this.conf.backward.length;t++){var n=this.conf.backward[t],r=n.split(">"),i=s(r[0]),o=s(r[1]);if(i=="*")for(var u in this.map)if(u!=o){var a=u+" > "+o;this.conf._backward[a]=1}if(o=="*")for(var u in this.map)if(u!=i){var a=i+" > "+u;this.conf._backward[a]=1}this.conf._backward[n]=1}}console.log(this.conf)}else this.driveByHash=!!e},setLoadingTip:function(e){typeof e.show=="function"&&typeof e.hide=="function"&&(this.loadingTip=e)},_bindEvents:function(){var e=this;window.addEventListener("hashchange",function(t){e._onHashChange()},!1)},_onHashChange:function(){this.driveByHash&&this.navigate(location.hash)},_getElByHash:function(e){var t;for(var n in this._hash2reg)if(this._hash2reg[n].test(e))return this.map[n]},_isBackward:function(e,t){if(this.conf&&e&&t){var n=s(e.getAttribute("data-mh")),r=s(t.getAttribute("data-mh"));if(n&&r){var i=n+" > "+r;return!!this.conf._backward[i]}}return!1},navigate:function(e,t){t==undefined&&(t=-1),this._prevHash=this._curHash;var e=location.hash.replace(/^#/,""),r=this._getElByHash(e);if(r){this._curHash=e,this._prevEl=this._curEl;if(this._prevEl==r){r.style.display="block";return}if(this._prevEl){t=this._isBackward(this._prevEl,r)?1:-1;var i=this._prevEl.offsetWidth;this._prevEl.style.webkitTransitionDuration="350ms",console.log(n(t*i)),this._prevEl.style.webkitTransform=n(t*i),this.loadingTip&&this.loadingTip.show(),setTimeout(function(e){return function(){e.style.webkitTransitionDuration=0,e.style.webkitTransform="none",e.style.display="none",r.style.display="block",this.loadingTip&&this.loadingTip.hide()}}(this._prevEl),350)}else r.style.display="block";this._curEl=r}},forward:function(e,t){t==undefined&&(t=!0);var n=this.driveByHash,r=this;this.driveByHash=!1,t&&(location.hash="#"+e.replace(/^#/,"")),this.navigate(e,-1),setTimeout(function(){r.driveByHash=n},0)},backward:function(e,t){t==undefined&&(t=!0);var n=this.driveByHash,r=this;e||(e=this._prevHash),this.driveByHash=!1,t&&(location.hash="#"+e.replace(/^#/,"")),this.navigate(e,1),setTimeout(function(){r.driveByHash=n},0)}},o});